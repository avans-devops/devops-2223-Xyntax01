name: devops-2223-xyntax01

# The build section defines how to build the images of your development environment
# More info: https://www.okteto.com/docs/reference/manifest/#build
build:
  # You can use the following env vars to refer to this image in your deploy commands:
  #  - OKTETO_BUILD_API-GATEWAY_REGISTRY: image registry
  #  - OKTETO_BUILD_API-GATEWAY_REPOSITORY: image repo
  #  - OKTETO_BUILD_API-GATEWAY_IMAGE: image name
  #  - OKTETO_BUILD_API-GATEWAY_TAG: image tag
  api-gateway:
    context: api-gateway
    dockerfile: api-gateway\Dockerfile

  # You can use the following env vars to refer to this image in your deploy commands:
  #  - OKTETO_BUILD_AUTH-SERVICE_REGISTRY: image registry
  #  - OKTETO_BUILD_AUTH-SERVICE_REPOSITORY: image repo
  #  - OKTETO_BUILD_AUTH-SERVICE_IMAGE: image name
  #  - OKTETO_BUILD_AUTH-SERVICE_TAG: image tag
  auth-service:
    context: auth-service
    dockerfile: auth-service\Dockerfile

  # You can use the following env vars to refer to this image in your deploy commands:
  #  - OKTETO_BUILD_GRAFANA_REGISTRY: image registry
  #  - OKTETO_BUILD_GRAFANA_REPOSITORY: image repo
  #  - OKTETO_BUILD_GRAFANA_IMAGE: image name
  #  - OKTETO_BUILD_GRAFANA_TAG: image tag
  grafana:
    context: grafana
    dockerfile: grafana\Dockerfile

  # You can use the following env vars to refer to this image in your deploy commands:
  #  - OKTETO_BUILD_PROFILE-SERVICE_REGISTRY: image registry
  #  - OKTETO_BUILD_PROFILE-SERVICE_REPOSITORY: image repo
  #  - OKTETO_BUILD_PROFILE-SERVICE_IMAGE: image name
  #  - OKTETO_BUILD_PROFILE-SERVICE_TAG: image tag
  profile-service:
    context: profile-service
    dockerfile: profile-service\Dockerfile

  # You can use the following env vars to refer to this image in your deploy commands:
  #  - OKTETO_BUILD_PROMETHEUS_REGISTRY: image registry
  #  - OKTETO_BUILD_PROMETHEUS_REPOSITORY: image repo
  #  - OKTETO_BUILD_PROMETHEUS_IMAGE: image name
  #  - OKTETO_BUILD_PROMETHEUS_TAG: image tag
  prometheus:
    context: .
    dockerfile: .
    image: prom/prometheus:latest

  # You can use the following env vars to refer to this image in your deploy commands:
  #  - OKTETO_BUILD_TARGET-SERVICE_REGISTRY: image registry
  #  - OKTETO_BUILD_TARGET-SERVICE_REPOSITORY: image repo
  #  - OKTETO_BUILD_TARGET-SERVICE_IMAGE: image name
  #  - OKTETO_BUILD_TARGET-SERVICE_TAG: image tag
  target-service:
    context: target-service
    dockerfile: target-service\Dockerfile

# The deploy section defines how to deploy your development environment
# More info: https://www.okteto.com/docs/reference/manifest/#deploy
deploy:
  compose:
    file: docker-compose.yml
# The dependencies section defines other git repositories to be deployed as part of your development environment
# More info: https://www.okteto.com/docs/reference/manifest/#dependencies
# dependencies:
#   - https://github.com/okteto/sample

# The dev section defines how to activate a development container
# More info: https://www.okteto.com/docs/reference/manifest/#dev
dev:
  prometheus:
    image: prom/prometheus:latest
    command:
      - --web.enable-lifecycle
      - --config.file=/etc/prometheus/prometheus.yml
    sync:
      - prometheus:/etc/prometheus
